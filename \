use dialoguer::{theme::ColorfulTheme, Select};
use cpal::traits::HostTrait;
use cpal::traits::DeviceTrait;
use cpal::platform::Host;


fn show_devices(host: Host){
    println!("Output devices:");
    for device in host.output_devices().unwrap() {
        println!(" - {}", device.name().unwrap());
    }
    println!("Input devices:");
    for device in host.input_devices().unwrap() {
        println!(" - {}", device.name().unwrap());
    }
}

fn main() {

    let host: Host = cpal::default_host();
    show_devices(host);
    // Initialize Audio API
    // Query the API - List Interfaces
    // Display Interface Options (for the user)
    // User Interface Choice (save that choice and initiliaze accordingly)
    // User Format Choice
    // Setup Recording (Selected Interface, Sample Rate, Bit Depth, Channels)
    // Start Recording
    // Create buffer
    // Use While loop to append incoming data to the buffer
    // Get user input to start or stop recording
    // Convert data to the format
    // Write Buffer to File

    // Playback:
    // Setup playback engine
    // Read file to buffer
    // Start Playback (for data chunk in audio data write to hardware)
    // Release Resources

}

fn selections() {
    let selections = &[
        "Select Input Device",
        "Select Output Device",
        "Record Audio",
    ];

    let selection = Select::with_theme(&ColorfulTheme::default())
        .with_prompt("Select and option")
        .default(0)
        .items(&selections[..])
        .interact()
        .unwrap();

    println!("Enjoy your {}!", selections[selection]);

    let selection = Select::with_theme(&ColorfulTheme::default())
        .with_prompt("Optionally pick your flavor")
        .default(0)
        .items(&selections[..])
        .interact_opt()
        .unwrap();

    if let Some(selection) = selection {
        println!("Enjoy your {}!", selections[selection]);
    } else {
        println!("You didn't select anything!");
    }

    let selection = Select::with_theme(&ColorfulTheme::default())
        .with_prompt("Pick your flavor, hint it might be on the second page")
        .default(0)
        .max_length(2)
        .items(&selections[..])
        .interact()
        .unwrap();

    println!("Enjoy your {}!", selections[selection]);
}
